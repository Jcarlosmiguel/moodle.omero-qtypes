define(["jquery","qtype_omerocommon/moodle-forms-utils","qtype_omerocommon/answer-base","qtype_omerocommon/multilanguage-element","qtype_omerocommon/multilanguage-attoeditor","qtype_omerocommon/image-viewer"],function(a,b,c,d,e,f){function g(a,b){return a.answer_input_name.replace(":","-")+"-"+b}function h(a){var b=a,c=b._config;for(var d in c.focusable_rois){var e=c.focusable_rois[d],f=b._image_viewer_controller.getShape(e);if(f){var h=f.toJSON().stroke_color,k=g(c,j.GOTO)+e+"_container",l=e.replace("_"," ");l=l.charAt(0).toUpperCase()+l.substring(1),h=h?'style="color: '+h+';"':"";var m=i('<div id="'+k+'"><i id="'+g(c,j.GOTO)+e+'_btn"  class="glyphicon glyphicon-map-marker" '+h+"></i>"+(parseInt(d)+1!=c.focusable_rois.length?", ":" ")+"</div>");b._focus_areas_container.append(m),i("#"+g(c,j.GOTO)+e+"_btn").bind("click",{marker_id:e},function(a){b._image_viewer_controller.setFocusOnRoiShape(a.data.marker_id,!0)})}}b._image_viewer_controller.showRoiShapes(c.focusable_rois,!0)}var i=jQuery,j={GOTO:"goto_marker_ctrl_id"};console.log("Initialized",this),M.qtypes=M.qtypes||{},M.qtypes.omerocommon=M.qtypes.omerocommon||{},M.qtypes.omerocommon.QuestionPlayerBase=function(){var a=this;a.constructor!=M.qtypes.omerocommon.QuestionPlayerBase&&M.qtypes.omerocommon.QuestionPlayerBase.instances.push(a)},M.qtypes.omerocommon.QuestionPlayerBase.instances=[],M.qtypes.omerocommon.QuestionPlayerBase.getInstances=function(){return M.qtypes.omerocommon.QuestionPlayerBase.instances};var k=M.qtypes.omerocommon.QuestionPlayerBase.prototype;return k.initialize=function(a){this._config=a,console.log("Configuration",a),this._focus_areas_container=i("#"+a.focus_areas_container);var b=new f(a.image_id,a.image_properties,a.image_server,a.image_viewer_container,a.image_annotations_canvas_id,a.viewer_model_server);this._image_viewer_controller=b},k.start=function(){this._image_viewer_controller.open(!0,function(){console.log("ImageViewer initialized!!!")})},k.showFocusAreas=function(){h(this)},M.qtypes.omerocommon.QuestionPlayerBase});