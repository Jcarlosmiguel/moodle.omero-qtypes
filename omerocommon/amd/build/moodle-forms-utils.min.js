define(["jquery"],function(a){var b=jQuery;M.qtypes=M.qtypes||{},M.qtypes.omerocommon=M.qtypes.omerocommon||{},M.qtypes.omerocommon.MoodleFormUtils=function(){var a=this;a._dynamic_elements={}};var c=M.qtypes.omerocommon.MoodleFormUtils.prototype,d=M.qtypes.omerocommon.MoodleFormUtils;return c.appendElementByContainerId=function(a,c,e){var f=this,g=b(e),h=b("#"+editor_container_id+" div.fcontainer");editor_container_id.length||console.error("FieldSet "+editor_container_id+" not found!!!"),g.attr("id")||g.attr("id",d.generateGuid());var i=d.generateGuid(),j=b('<div class="fitem" id="'+i+'"></div>');return j.attr("container-of",g.attr("id")),j.html(['<div class="fitemtitle"><label for="'+g.attr("id")+'">'+c+"</label></div>",'<div class="felement">',"<div>",g.get(0).outerHTML,"</div>","</div>"].join(" ")),h.append(j),f._dynamic_elements[g.attr("id")]=j,j},c.appendElement=function(a,c,e,f){var g=this,h=b(e),i=b(a);i.attr("id")||i.attr("id",d.generateGuid()),h.attr("id")||h.attr("id",d.generateGuid());var j=d.generateGuid(),k=b('<div class="fitem" id="'+j+'"></div>');return k.attr("container-of",h.attr("id")),k.html(['<div class="fitemtitle"><label for="'+h.attr("id")+'">'+c+"</label></div>",'<div class="felement">',"<div>",h.get(0).outerHTML,f&&f.length>0?'<input type="hidden" name="'+f+'" value="{}" />':"","</div>","</div>"].join(" ")),i.append(k),g._dynamic_elements[h.attr("id")]=k,k},c.removeElementFromFieldSet=function(a){var c=this,d=b("#"+a);return d.length?(d.parent().parent().remove(),delete c._dynamic_elements[a],!0):(console.error("Element "+a+" doesn't exist"),!1)},d.generateGuid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d.initDropdown=function(){var a=b(".dropdown-toggle");a.length&&a.dropdown()},d.iniPopupOver=function(){var a=b('[data-toggle="popover"]');a.length>0&&a.popover()},d.initModelPanels=function(a){b("#"+a).modal()},d.appendHiddenElement=function(a,c){try{var e=b(c),f=b(a);f.attr("id")||f.attr("id",d.generateGuid()),e.attr("id")||e.attr("id",d.generateGuid()),f.append(e)}catch(g){console.error(g)}},d.htmlentities=function(a,b,c,e){var f=d.getHtmlTranslationTable("HTML_ENTITIES",b);if(a=null==a?"":a+"",!f)return!1;b&&"ENT_QUOTES"===b&&(f["'"]="&#039;"),e=null==e||!!e;var g=new RegExp("&(?:#\\d+|#x[\\da-f]+|[a-zA-Z][\\da-z]*);|["+Object.keys(f).join("").replace(/([()[\]{}\-.*+?^$|\/\\])/g,"\\$1")+"]","g");return a.replace(g,function(a){return a.length>1?e?f["&"]+a.substr(1):a:f[a]})},d.htmlspecialchars=function(a,b,c,d){var e=0,f=0,g=!1;("undefined"==typeof b||null===b)&&(b=2),a=a||"",a=a.toString(),d!==!1&&(a=a.replace(/&/g,"&amp;")),a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");var h={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===b&&(g=!0),"number"!=typeof b){for(b=[].concat(b),f=0;f<b.length;f++)0===h[b[f]]?g=!0:h[b[f]]&&(e|=h[b[f]]);b=e}return b&h.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/'/g,"&#039;")),g||(a=a.replace(/"/g,"&quot;")),a},d.htmlEntityDecode=function(a,b){var c={},e="",f="",g="";if(f=a.toString(),!1===(c=d.getHtmlTranslationTable("HTML_ENTITIES",b)))return!1;delete c["&"],c["&"]="&amp;";for(e in c)g=c[e],f=f.split(g).join(e);return f=f.split("&#039;").join("'")},d.getHtmlTranslationTable=function(a,b){var c,d={},e={},f={},g={},h={},i={};if(f[0]="HTML_SPECIALCHARS",f[1]="HTML_ENTITIES",g[0]="ENT_NOQUOTES",g[2]="ENT_COMPAT",g[3]="ENT_QUOTES",h=isNaN(a)?a?a.toUpperCase():"HTML_SPECIALCHARS":f[a],i=isNaN(b)?b?b.toUpperCase():"ENT_COMPAT":g[b],"HTML_SPECIALCHARS"!==h&&"HTML_ENTITIES"!==h)throw new Error("Table: "+h+" not supported");d[38]="&amp;","HTML_ENTITIES"===h&&(d[160]="&nbsp;",d[161]="&iexcl;",d[162]="&cent;",d[163]="&pound;",d[164]="&curren;",d[165]="&yen;",d[166]="&brvbar;",d[167]="&sect;",d[168]="&uml;",d[169]="&copy;",d[170]="&ordf;",d[171]="&laquo;",d[172]="&not;",d[173]="&shy;",d[174]="&reg;",d[175]="&macr;",d[176]="&deg;",d[177]="&plusmn;",d[178]="&sup2;",d[179]="&sup3;",d[180]="&acute;",d[181]="&micro;",d[182]="&para;",d[183]="&middot;",d[184]="&cedil;",d[185]="&sup1;",d[186]="&ordm;",d[187]="&raquo;",d[188]="&frac14;",d[189]="&frac12;",d[190]="&frac34;",d[191]="&iquest;",d[192]="&Agrave;",d[193]="&Aacute;",d[194]="&Acirc;",d[195]="&Atilde;",d[196]="&Auml;",d[197]="&Aring;",d[198]="&AElig;",d[199]="&Ccedil;",d[200]="&Egrave;",d[201]="&Eacute;",d[202]="&Ecirc;",d[203]="&Euml;",d[204]="&Igrave;",d[205]="&Iacute;",d[206]="&Icirc;",d[207]="&Iuml;",d[208]="&ETH;",d[209]="&Ntilde;",d[210]="&Ograve;",d[211]="&Oacute;",d[212]="&Ocirc;",d[213]="&Otilde;",d[214]="&Ouml;",d[215]="&times;",d[216]="&Oslash;",d[217]="&Ugrave;",d[218]="&Uacute;",d[219]="&Ucirc;",d[220]="&Uuml;",d[221]="&Yacute;",d[222]="&THORN;",d[223]="&szlig;",d[224]="&agrave;",d[225]="&aacute;",d[226]="&acirc;",d[227]="&atilde;",d[228]="&auml;",d[229]="&aring;",d[230]="&aelig;",d[231]="&ccedil;",d[232]="&egrave;",d[233]="&eacute;",d[234]="&ecirc;",d[235]="&euml;",d[236]="&igrave;",d[237]="&iacute;",d[238]="&icirc;",d[239]="&iuml;",d[240]="&eth;",d[241]="&ntilde;",d[242]="&ograve;",d[243]="&oacute;",d[244]="&ocirc;",d[245]="&otilde;",d[246]="&ouml;",d[247]="&divide;",d[248]="&oslash;",d[249]="&ugrave;",d[250]="&uacute;",d[251]="&ucirc;",d[252]="&uuml;",d[253]="&yacute;",d[254]="&thorn;",d[255]="&yuml;"),"ENT_NOQUOTES"!==i&&(d[34]="&quot;"),"ENT_QUOTES"===i&&(d[39]="&#39;"),d[60]="&lt;",d[62]="&gt;";for(c in d)d.hasOwnProperty(c)&&(e[String.fromCharCode(c)]=d[c]);return e},M.qtypes.omerocommon.MoodleFormUtils});